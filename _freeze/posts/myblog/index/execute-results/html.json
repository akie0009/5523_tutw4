{
  "hash": "e55d0c3288e4b7d3787e266e458b10d2",
  "result": {
    "markdown": "---\ntitle: \"Penguin\"\nformat: html\neditor: visual\nauthor: \"Anh Thu Kieu\"\ndate: \"2023-08-19\"\ncategories: [news, code, analysis]\nimage: penguin.jpeg\n---\n\nThis is penguin analysis.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(palmerpenguins)\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.2     ✔ readr     2.1.4\n✔ forcats   1.0.0     ✔ stringr   1.5.0\n✔ ggplot2   3.4.3     ✔ tibble    3.2.1\n✔ lubridate 1.9.2     ✔ tidyr     1.3.0\n✔ purrr     1.0.2     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n```\n:::\n\n```{.r .cell-code}\nlibrary(ggbeeswarm)\nlibrary(broom)\nlibrary(visdat)\n# library(nullabor)\nlibrary(ggplot2)\n```\n:::\n\n\na.  \n\n\n::: {.cell}\n\n```{.r .cell-code}\nglimpse(penguins)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRows: 344\nColumns: 8\n$ species           <fct> Adelie, Adelie, Adelie, Adelie, Adelie, Adelie, Adel…\n$ island            <fct> Torgersen, Torgersen, Torgersen, Torgersen, Torgerse…\n$ bill_length_mm    <dbl> 39.1, 39.5, 40.3, NA, 36.7, 39.3, 38.9, 39.2, 34.1, …\n$ bill_depth_mm     <dbl> 18.7, 17.4, 18.0, NA, 19.3, 20.6, 17.8, 19.6, 18.1, …\n$ flipper_length_mm <int> 181, 186, 195, NA, 193, 190, 181, 195, 193, 190, 186…\n$ body_mass_g       <int> 3750, 3800, 3250, NA, 3450, 3650, 3625, 4675, 3475, …\n$ sex               <fct> male, female, female, NA, female, male, female, male…\n$ year              <int> 2007, 2007, 2007, 2007, 2007, 2007, 2007, 2007, 2007…\n```\n:::\n:::\n\n\nb.  \n\n\n::: {.cell}\n\n```{.r .cell-code}\n?palmerpenguins\n```\n:::\n\n\nc.  \n\n\n::: {.cell}\n\n```{.r .cell-code}\nvis_dat(penguins)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\nMissing values in gender and flipper length, body mass, bill length, bill depth.\n\nd.  Check the distributions of each species on each of the size variables, using a jittered dotplot, using the geom_quasirandom() function in the ggbeeswarm package. There seems to be some bimodality in some species on some variables eg bill_length_mm. Why do you think this might be? Check your thinking by making a suitable plot.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#?geom_quasirandom\n\nggplot(penguins,\n       aes(x = species, \n           y = bill_length_mm,\n           color = sex)) + \n  geom_quasirandom() +\n  scale_color_brewer(\"\", palette = \"Dark2\") +\n  coord_flip()\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Removed 2 rows containing missing values (`position_quasirandom()`).\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Removed 9 rows containing missing values (`geom_point()`).\n```\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\nDistribution of Adelie normal, but not for Gentoo and Chinstrap becuz of 2 peaks (bimodality). This happens becuz the difference between gender (male and female). Gentoo and Chinstrap: male \\> female in general. Each gender among each species, the distribution of Gentoo and Chinstrap is right skewed, Adelie left skewed.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(penguins,\n       aes(x = species, \n           y = flipper_length_mm,\n           color = sex)) + \n  geom_quasirandom() +\n  scale_color_brewer(\"\", palette = \"Dark2\") +\n  coord_flip()\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Removed 2 rows containing missing values (`position_quasirandom()`).\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Removed 9 rows containing missing values (`geom_point()`).\n```\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(penguins,\n       aes(x = species, \n           y = body_mass_g,\n           color = sex)) + \n  geom_quasirandom() +\n  scale_color_brewer(\"\", palette = \"Dark2\") +\n  coord_flip()\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Removed 2 rows containing missing values (`position_quasirandom()`).\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Removed 9 rows containing missing values (`geom_point()`).\n```\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\nAdelie's distribution has no outliers.\n\nf.  Make a scatterplot of body_mass_g vs flipper_length_mm for all the penguins. What do the vertical stripes indicate? Are there any other unusual patterns to note, such as outliers or clustering or nonlinearity?\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(penguins,\n       aes(x = flipper_length_mm, \n           y = body_mass_g)) +\n  geom_point()\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Removed 2 rows containing missing values (`geom_point()`).\n```\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n\nthe vertical stripes indicate that the number is rounded.\n\ng.  How well can penguin body mass be predicted based on the flipper length? Fit a linear model to check. Report the equation, the , , and make a residual plot of residuals vs flipper_length_mm. From the residual plot, are there any concerns about the model fit?\n\n\n::: {.cell}\n\n```{.r .cell-code}\npenguins_nona <- penguins %>% na.omit()\npenguins_fit <- lm(body_mass_g ~ flipper_length_mm,\n                   data = penguins_nona)\ntidy(penguins_fit)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 2 × 5\n  term              estimate std.error statistic   p.value\n  <chr>                <dbl>     <dbl>     <dbl>     <dbl>\n1 (Intercept)        -5872.     310.       -18.9 1.18e- 54\n2 flipper_length_mm     50.2      1.54      32.6 3.13e-105\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Bodymass = -5872 + flipper_length_mm * 50\n\nflipper_length_mm <- 200\n-5872 + flipper_length_mm * 50\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 4128\n```\n:::\n\n```{.r .cell-code}\n# 4128g +- 770g (CI)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nglance(penguins_fit)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 1 × 12\n  r.squared adj.r.squared sigma statistic   p.value    df logLik   AIC   BIC\n      <dbl>         <dbl> <dbl>     <dbl>     <dbl> <dbl>  <dbl> <dbl> <dbl>\n1     0.762         0.761  393.     1060. 3.13e-105     1 -2461. 4928. 4940.\n# ℹ 3 more variables: deviance <dbl>, df.residual <int>, nobs <int>\n```\n:::\n\n```{.r .cell-code}\n#lower CI? mean + Tcrit *sd\n\n1.96 *393\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 770.28\n```\n:::\n:::\n\n\nResidual plot:\n\n\n::: {.cell}\n\n```{.r .cell-code}\npenguins_m <- augment (penguins_fit)\nggplot (penguins_m, aes (x=flipper_length_mm, y=.resid)) +\n  geom_hline(yintercept=1, colour=\"grey70\") +\n  geom_point() +\n  theme (aspect.ratio=1)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-12-1.png){width=672}\n:::\n:::\n\n\nnegative rls left group, positive for right group.\n\nExercise 2: Can we believe what we see? a.\n\n\n\"True data in position 14\", if we cannot find the true plot, then the true plot is good.\n\nb.  Pick one group, males or females, and one of Adelie, Chinstrap or Gentoo, and choose two of the four measurements. Fit a linear model, and do a lineup of the residuals. Can you tell which is the true plot? Show your lineup to your tutorial partner or someone else nearby and ask them to pick the plot that is most different. explain why they picked that plot. Using your decrypt() code locate the true plot. Is the true plot different from the nulls?\n\nDid you or your friend choose the data plot? Was it identifiable from the lineup or indistinguishable from the null plots?\n\nCAnnot guess the true plot, they are all similar.\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}